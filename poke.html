<!DOCTYPE html>
<html lang="ja">

<head>
    <title>今日のポケモン</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    <style>
        #pokemon {
            width: 300px;
        }

        #pokemonImage {
            width: 100%;
        }

        img {
            width: 250px;
            height: 150px;
            object-fit: cover;
            border: 0.5px solid gray;
            background-color: white;
        }

        h2 {
            padding-bottom: 0;
        }
    </style>
</head>

<body>

    <main class="container">
        <h1>今日のポケモン</h1>

        <div id="pokemon"
            style="display: flex; flex-direction: column; gap:0px; background-color: rgb(235, 235, 235); border-radius: 20px; padding: 16px;">
            <div style="padding: 20px; padding-bottom: 190px; padding-top: 8px; background-color: white;">
                <h2 id="pokemonNameJa" style="font-size: 16px; font-weight: bold; margin-bottom: 6px;"></h2>
                <!-- <h3 id="pokemonNameEn"></h3> -->
                <img id="pokemonImage" src="">
            </div>
        </div>
    </main>

    <script>
        let pokemonNameJa = document.getElementById('pokemonNameJa');
        //let pokemonNameEn = document.getElementById('pokemonNameEn');
        let pokemonImage = document.getElementById('pokemonImage');

        // ポケモンは現在898種
        let pokemonNumber = Math.floor(Math.random() * 898) + 1;

        // 日本語名を取得する関数
        async function getPokemonJapaneseName(idOrName) {
            try {
                const response = await fetch(`https://pokeapi.co/api/v2/pokemon-species/${idOrName}`);
                if (!response.ok) throw new Error('情報の取得に失敗しました');
                const data = await response.json();
                const ja = data.names.find(n => n.language.name === "ja" || n.language.name === "ja-Hrkt");
                return ja ? ja.name : '日本語名が見つかりません';
            } catch (error) {
                return `エラー: ${error.message}`;
            }
        }

        // ポケモンのデータを取得して表示
        async function showPokemon(id) {
            try {
                const resPokemon = await fetch(`https://pokeapi.co/api/v2/pokemon/${id}`);
                const pokemonData = await resPokemon.json();

                const japaneseName = await getPokemonJapaneseName(id);

                // 表示
                pokemonNameJa.textContent = japaneseName;
                //pokemonNameEn.textContent = pokemonData.name;

                // 画像表示
                pokemonImage.src = pokemonData.sprites.front_default;

            } catch (error) {
                console.error(`エラーが発生しました: ${error}`);
            }
        }

        // ランダムなポケモンを表示
        showPokemon(pokemonNumber);
    </script>

</body>

</html>